import math
# * Constants for the detail model

# * Molar mass constants
type
  # ? Gas composition is used to define the molar mass of each of the possible gasses in the
  # ? Composition. We could have defined these as constants directly.
  GasComp = tuple
    Carbon   : int
    Hydrogen : int
    Oxygen   : int
    Sulfur   : int
    Nitrogen : int
    Helium   : int
    Argon    : int
    
  MolarMass = float # * g/mol
  MolarMasses = array[1..21, MolarMass]
  
  MolecularWeight = float
  Molecule = tuple
    MW: MolecularWeight

const
  carbon   : Molecule = (MW: 12.01100)
  hydrogen : Molecule = (MW: 1.00794)
  oxygen   : Molecule = (MW: 15.99940)
  sulfur   : Molecule = (MW: 32.06600)
  nitrogen : Molecule = (MW: 14.00674)
  helium   : Molecule = (MW: 4.00260)
  argon    : Molecule = (MW: 39.94800)

proc gasCompMM(gasComp : GasComp) : MolarMass =
  var
    masses : array[7, MolecularWeight] = [
      carbon.MW    * float(gasComp.Carbon),
      hydrogen.MW  * float(gasComp.Hydrogen),
      oxygen.MW    * float(gasComp.Oxygen),
      sulfur.MW    * float(gasComp.Sulfur),
      nitrogen.MW  * float(gasComp.Nitrogen),
      helium.MW    * float(gasComp.Helium),
      argon.MW     * float(gasComp.Argon)
    ]
  for mass in masses:
    result = result + mass

const
  molarMasses : MolarMasses = [
  # ?           C,  H,  O,  S,  N, He, Ar
    gasCompMM(( 1,  4,  0,  0,  0,  0,  0)), # ? Methane
    gasCompMM(( 0,  0,  0,  0,  2,  0,  0)), # ? Nitrogen
    gasCompMM(( 1,  0,  2,  0,  0,  0,  0)), # ? Carbon dioxide
    gasCompMM(( 2,  6,  0,  0,  0,  0,  0)), # ? Ethane
    gasCompMM(( 3,  8,  0,  0,  0,  0,  0)), # ? Propane
    gasCompMM(( 4, 10,  0,  0,  0,  0,  0)), # ? Isobutane
    gasCompMM(( 4, 10,  0,  0,  0,  0,  0)), # ? n-Butane
    gasCompMM(( 5, 12,  0,  0,  0,  0,  0)), # ? Isopentane
    gasCompMM(( 5, 12,  0,  0,  0,  0,  0)), # ? n-Pentane
    gasCompMM(( 6, 14,  0,  0,  0,  0,  0)), # ? Hexane
    gasCompMM(( 7, 16,  0,  0,  0,  0,  0)), # ? Heptane
    gasCompMM(( 8, 18,  0,  0,  0,  0,  0)), # ? Octane
    gasCompMM(( 9, 20,  0,  0,  0,  0,  0)), # ? Nonane
    gasCompMM((10, 22,  0,  0,  0,  0,  0)), # ? Decane
    gasCompMM(( 0,  2,  0,  0,  0,  0,  0)), # ? Hydrogen
    gasCompMM(( 0,  0,  2,  0,  0,  0,  0)), # ? Oxygen
    gasCompMM(( 1,  0,  1,  0,  0,  0,  0)), # ? Carbon monoxide
    gasCompMM(( 0,  2,  1,  0,  0,  0,  0)), # ? Water
    gasCompMM(( 0,  2,  0,  1,  0,  0,  0)), # ? Hydrogen sulfide
    gasCompMM(( 0,  0,  0,  0,  0,  1,  0)), # ? Helium
    gasCompMM(( 0,  0,  0,  0,  0,  0,  1)), # ? Argon
  ]


# * Other constants and types
type
  Temperature = float # * kelvin
  Density = float # * mol/l

  Pressure = float # * kPa
  Compressibility = float

const
  rDetail : float = 8.31451

type
  Terms*[T] = array[1..58, T]
  Fields*[T] = array[1..21, T]

const
  # ? Coefficients of the equation of state
  an : Terms[float] = [
                   0.15383260000000,  1.341953000, -2.998583000, -0.048312280,  0.375796500,
    -1.589575000, -0.05358847000000,  0.886594630, -0.710237040, -1.471722000,  1.321850350,
    -0.786659250,  0.00000000229129,  0.157672400, -0.436386400, -0.044081590, -0.003433888,
     0.032059050,  0.02487355000000,  0.073322790, -0.001600573,  0.642470600, -0.416260100,
    -0.066899570,  0.27917950000000, -0.696605100, -0.002860589, -0.008098836,  3.150547000,
     0.007224479, -0.70575290000000,  0.534979200, -0.079314910, -1.418465000, -5.99905E-17,
     0.105840200,  0.03431729000000, -0.007022847,  0.024955870,  0.042968180,  0.746545300,
    -0.291961300,  7.29461600000000, -9.936757000, -0.005399808, -0.243256700,  0.049870160,
     0.003733797,  1.87495100000000,  0.002168144, -0.658716400,  0.000205518,  0.009776195,
    -0.020487080,  0.01557322000000,  0.006862415, -0.001226752,  0.002850908,
  ]

  # ? Density exponents
  bn : Terms[int] = [                                     # * i
    1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, # * 1  - 18
    2, 2, 2, 2, 2, 2, 2, 2, 2,                            # * 19 - 27
    3, 3, 3, 3, 3, 3, 3, 3, 3, 3,                         # * 28 - 37
    4, 4, 4, 4, 4, 4, 4,                                  # * 38 - 44
    5, 5, 5, 5, 5,                                        # * 45 - 49
    6, 6,                                                 # * 50 - 51
    7, 7,                                                 # * 52 - 53
    8, 8, 8,                                              # * 54 - 56
    9, 9,                                                 # * 57 - 58
  ]

  # ? Exponents on density in EXP[-cn*D^kn] part
  # ? cn = 1 when kn != 0 and 0 otherwise
  kn : Terms[int] = [
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,    # * 1  - 12
    3, 2, 2, 2, 4, 4, 0, 0, 2, 2, 2, 4,    # * 13 - 24
    4, 4, 4, 0, 1, 1, 2, 2, 3, 3, 4, 4,    # * 25 - 36
    4, 0, 0, 2, 2, 2, 4, 4, 0, 2, 2, 4,    # * 37 - 48
    4, 0, 2, 0, 2, 1, 2, 2, 2, 2           # * 49 - 58
  ]

  # ? Temperature exponents
  un : Terms[float] = [
  # *  0     1     2    3     4     5     6    7    8      9    10    11    12      x
           0.0,  0.5, 1.0,  3.5, -0.5,  4.5, 0.5, 7.5,   9.5,  6.0, 12.0, 12.5, # * 0
    -6.0,  2.0,  3.0, 2.0,  2.0, 11.0, -0.5, 0.5, 0.0,   4.0,  6.0, 21.0, 23.0, # * 1
    22.0, -1.0, -0.5, 7.0, -1.0,  6.0,  4.0, 1.0, 9.0, -13.0, 21.0,  8.0, -0.5, # * 2
     0.0,  2.0,  7.0, 9.0, 22.0, 23.0,  1.0, 9.0, 3.0,   8.0, 23.0,  1.5,  5.0, # * 3
    -0.5,  4.0,  7.0, 3.0,  0.0,  1.0,  0.0,                                    # * 4
  ]

  # ? Flags
  fn : Terms[int] = [
# * 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15 (c)
        0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1,  0,  0, # * i = c
    0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1,  0,  0,  1,  0, # * i = 16 + c
    0,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, # * i = 32 + c
    0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,                     # * i = 48 + c
  ]

  gn : Terms[int] = [
# * 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15 (c)
        0,  0,  0,  0,  1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, # * i = c
    0,  0,  0,  0,  0,  0,  0,  0,  0,  1,  0,  0,  0,  1,  0,  0, # * i = 16 + c
    1,  1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, # * i = 32 + c
    0,  0,  0,  1,  0,  0,  1,  0,  1,  0,  0,                     # * i = 48 + c
  ]

  qn : Terms[int] = [
# * 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15 (c)
        0,  0,  0,  0,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0, # * i = c
    1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1,  0,  1,  0,  0,  0, # * i = 16 + c
    0,  0,  0,  0,  0,  1,  0,  0,  0,  0,  1,  0,  0,  0,  0,  1, # * i = 32 + c
    0,  1,  0,  0,  1,  0,  0,  0,  0,  0,  1,                     # * i = 48 + c
  ]

  sn : Terms[int] = [
# * 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15 (c)
        0,  0,  0,  0,  0,  0,  0,  1,  1,  0,  0,  0,  0,  0,  0, # * i = c
    0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, # * i = 16 + c
    0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, # * i = 32 + c
    0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,                     # * i = 48 + c
  ]

  wn : Terms[int] = [
# * 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15 (c)
        0,  0,  0,  0,  0,  0,  0,  0,  0,  1,  1,  1,  0,  0,  0, # * i = c
    0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, # * i = 16 + c
    0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, # * i = 32 + c
    0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,                     # * i = 48 + c
  ]

  # ? Energy parameters
  Ei : Fields[float] = [
# * 0, 1, 2, 3, 4, 5, 6, 7,
# * 8, 9, 10, 11, 12, 13, 14,
# * 15, 16, 17, 18, 19, 20, 21
    151.318300,  99.737780, 241.960600, 244.166700, 298.118300, 324.068900, 337.638900,
    365.599900, 370.682300, 402.636293, 427.722630, 450.325022, 470.840891, 489.558373,
    26.9579400, 122.766700, 105.534800, 514.015600, 296.355000,   2.610111, 119.629900,
  ]

  # ? Gas - Gas Energy parameters
  Eij : Fields[Fields[float]] = [
    [    # ? Methane
      1.0, 0.97164, 0.960644, 1.0, 0.994635, 1.01953, 0.989844,
      1.00235, 0.999268, 1.107274, 0.88088, 0.880973, 0.881067, 0.881161,
      1.17052, 1.0, 0.990126, 0.708218, 0.931484, 1.0, 1.0,
    ], [ # ? Nitrogen
      1.0, 1.0, 1.02274, 0.97012, 0.945939, 0.946914, 0.973384,
      0.95934, 0.94552, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.08632, 1.021, 1.00571, 0.746954, 0.902271, 1.0, 1.0,
    ], [ # ? Carbon Dioxide
      1.0, 1.0, 1.0, 0.925053, 0.960237, 0.906849, 0.897362,
      0.726255, 0.859764, 0.855134, 0.831229, 0.80831, 0.786323, 0.765171,
      1.28179, 1.0, 1.5, 0.849408, 0.955052, 1.0, 1.0,
    ], [ # ? Ethane
      1.0, 1.0, 1.0, 1.0, 1.02256, 1.0, 1.01306,
      1.0, 1.00532, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.16446, 1.0, 1.0, 0.693168, 0.946871, 1.0, 1.0,
    ], [ # ? Propane
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0049,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.034787, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
    ], [ # ? Isobutane
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.3, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
    ], [ # ? n-Butane
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.3, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
    ], [ # ? Isopentane
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
    ], [ # ? n-Pentane
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
    ], [ # ? Hexane
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.008692, 1.0, 1.0,
    ], [ # ? Heptane
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.010126, 1.0, 1.0,
    ], [ # ? Octane
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.011501, 1.0, 1.0,
    ], [ # ? Nonane
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.012821, 1.0, 1.0,
    ], [ # ? Decane
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.014089, 1.0, 1.0,
    ], [ # ? Hydrogen
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.1, 1.0, 1.0, 1.0, 1.0,
    ], [ # ? Oxygen
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
    ], [ # ? Carbon Monoxide
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
    ], [ # ? Water
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
    ], [ # ? Hydrogen Sulfide
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
    ], [ # ? Helium
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
    ], [ # ? Argon
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
    ],
  ]

    # ? Gas - Gas Conformal Energy Parameters
  Uij : Fields[Fields[float]] = [
    [    # ? Methane
      1.0, 0.886106, 0.963827, 1.0, 0.990877, 1.0, 0.992291,
      1.0, 1.00367, 1.302576, 1.191904, 1.205769, 1.219634, 1.233498,
      1.15639, 1.0, 1.0, 1.0, 0.736833, 1.0, 1.0,
    ], [ # ? Nitrogen
      1.0, 1.0, 0.835058, 0.816431, 0.915502, 1.0, 0.993556,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      0.408838, 1.0, 1.0, 1.0, 0.993476, 1.0, 1.0,
    ], [ # ? Carbon Dioxide
      1.0, 1.0, 1.0, 0.96987, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.066638, 1.077634, 1.088178, 1.098291, 1.108021,
      1.0, 1.0, 0.9, 1.0, 1.04529, 1.0, 1.0,
    ], [ # ? Ethane
      1.0, 1.0, 1.0, 1.0, 1.065173, 1.25, 1.25,
      1.25, 1.25, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.61666, 1.0, 1.0, 1.0, 0.971926, 1.0, 1.0,
    ], [ # ? Propane
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
    ], [ # ? Isobutane
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
    ], [ # ? n-Butane
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
    ], [ # ? Isopentane
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
    ], [ # ? n-Pentane
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
    ], [ # ? Hexane
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.028973, 1.0, 1.0,
    ], [ # ? Heptane
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.033754, 1.0, 1.0,
    ], [ # ? Octane
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.038338, 1.0, 1.0,
    ], [ # ? Nonane
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.042735, 1.0, 1.0,
    ], [ # ? Decane
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.046966, 1.0, 1.0,
    ], [ # ? Hydrogen
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
    ], [ # ? Oxygen
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
    ], [ # ? Carbon Monoxide
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
    ], [ # ? Water
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
    ], [ # ? Hydrogen Sulfide
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
    ], [ # ? Helium
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
    ], [ # ? Argon
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
    ],
  ]

    # ? Gas - Gas Size parameters
  Kij : Fields[Fields[float]] = [
    [    # ? Methane
      1.0, 1.00363, 0.995933, 1.0, 1.007619, 1.0, 0.997596,
      1.0, 1.002529, 0.982962, 0.983565, 0.982707, 0.981849, 0.980991,
      1.02326, 1.0, 1.0, 1.0, 1.00008, 1.0, 1.0,
    ], [ # ? Nitrogen
      1.0, 1.0, 0.982361, 1.00796, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.03227, 1.0, 1.0, 1.0, 0.942596, 1.0, 1.0,
    ], [ # ? Carbon Dioxide
      1.0, 1.0, 1.0, 1.00851, 1.0, 1.0, 1.0,
      1.0, 1.0, 0.910183, 0.895362, 0.881152, 0.86752, 0.854406,
      1.0, 1.0, 1.0, 1.0, 1.00779, 1.0, 1.0,
    ], [ # ? Ethane
      1.0, 1.0, 1.0, 1.0, 0.986893, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.02034, 1.0, 1.0, 1.0, 0.999969, 1.0, 1.0,
    ], [ # ? Propane
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
    ], [ # ? Isobutane
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
    ], [ # ? n-Butane
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
    ], [ # ? Isopentane
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
    ], [ # ? n-Pentane
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
    ], [ # ? Hexane
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 0.96813, 1.0, 1.0,
    ], [ # ? Heptane
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 0.96287, 1.0, 1.0,
    ], [ # ? Octane
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 0.957828, 1.0, 1.0,
    ], [ # ? Nonane
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 0.952441, 1.0, 1.0,
    ], [ # ? Decane
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 0.948338, 1.0, 1.0,
    ], [ # ? Hydrogen
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
    ], [ # ? Oxygen
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
    ], [ # ? Carbon Monoxide
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
    ], [ # ? Water
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
    ], [ # ? Hydrogen Sulfide
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
    ], [ # ? Helium
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
    ], [ # ? Argon
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
    ],
  ]

    # ? Gas - Gas Orientation Parameters
  Gij : Fields[Fields[float]] = [
    [    # ? Methane
      1.0, 1.0, 0.807653, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.95731, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
    ], [ # ? Nitrogen
      1.0, 1.0, 0.982746, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
    ], [ # ? Carbon Dioxide
      1.0, 1.0, 1.0, 0.370296, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.67309, 1.0, 1.0, 1.0,
    ], [ # ? Ethane
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
    ], [ # ? Propane
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
    ], [ # ? Isobutane
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
    ], [ # ? n-Butane
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
    ], [ # ? Isopentane
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
    ], [ # ? n-Pentane
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
    ], [ # ? Hexane
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
    ], [ # ? Heptane
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
    ], [ # ? Octane
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
    ], [ # ? Nonane
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
    ], [ # ? Decane
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
    ], [ # ? Hydrogen
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
    ], [ # ? Oxygen
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
    ], [ # ? Carbon Monoxide
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
    ], [ # ? Water
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
    ], [ # ? Hydrogen Sulfide
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
    ], [ # ? Helium
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
    ], [ # ? Argon
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
    ],
  ]

  # ? Size parameters
  Ki : Fields[float] = [
    0.4619255, 0.4479153, 0.4557489, 0.5279209, 0.5837490, 0.6406937, 0.6341423,
    0.6738577, 0.6798307, 0.7175118, 0.7525189, 0.7849550, 0.8152731, 0.8437826,
    0.3514916, 0.4186954, 0.4533894, 0.3825868, 0.4618263, 0.3589888, 0.4216551,
  ]

  # ? Orientation parameters
  Gi : Fields[float] = [
    0.000000, 0.027815, 0.189065, 0.079300, 0.141239, 0.256692, 0.281835,
    0.332267, 0.366911, 0.289731, 0.337542, 0.383381, 0.427354, 0.469659,
    0.034369, 0.021000, 0.038953, 0.332500, 0.088500, 0.000000, 0.000000,
  ]

  # ? Quadrupole parameters
  Qi : Fields[float] = [
    0.0, 0.0, 0.69000, 0.0, 0.0, 0.0, 0.0,
    0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    0.0, 0.0, 0.0, 1.06775, 0.633276, 0.0, 0.0
  ]

  # ? High temp parameter
  Fi : Fields[float] = [
    0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0
  ]

  # ? Dipole parameter
  Si : Fields[float] = [
    0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    0.0, 0.0, 0.0, 1.5822, 0.39, 0.0, 0.0
  ]

  # ? Association parameter
  Wi : Fields[float] = [
    0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0
  ]

# * Calculated tables
var
  Ki25 : Fields[float]
  Ei25 : Fields[float]

  Kij5 : Fields[Fields[float]]
  Uij5 : Fields[Fields[float]]
  Gij5 : Fields[Fields[float]]

  Bsnij : float
  Bsnij2 : Fields[Fields[array[1..18, float]]]
  Bs : array[1..18, float]

  Csn : Terms[float]


for i in 1..21:
  Ki25[i] = pow(Ki[i], 2.5)
  Ei25[i] = pow(Ei[i], 2.5)

for i in 1..21:
  for j in 1..21:
    for k in 1..18:
      Bsnij = 1
      if gn[k] == 1:
        Bsnij = Gij[i][j] * (Gi[i] + Gi[j]) / 2
      if qn[k] == 1:
        Bsnij = Bsnij * Qi[i] * Qi[j]
      if fn[k] == 1:
        Bsnij = Bsnij * Fi[i] * Fi[j]
      if sn[k] == 1:
        Bsnij = Bsnij * Si[i] * Si[j]
      if wn[k] == 1:
        Bsnij = Bsnij * Wi[i] * Wi[j]
      Bsnij2[i][j][k] =
        an[k] *
        pow(Eij[i][j] * sqrt(Ei[i] * Ei[j]), un[k]) *
        pow(Ki[i] * Ki[j], 1.5) *
        Bsnij
    
    Kij5[i][j] = (pow(Kij[i][j], 5) - 1) * Ki25[i] * Ki25[j]
    Uij5[i][j] = (pow(Uij[i][j], 5) - 1) * Ei25[i] * Ei25[j]
    Gij5[i][j] = (Gij[i][j] - 1) * (Gi[i] + Gi[j]) / 2

const
  T0 = 298.15
  d0 = 101.325 / rDetail / T0

  # ? Gas - Gas Ideal Gas Parameters A
  n0i : Fields[array[1..7, float]] = [
    [    # ? Methane
      29.83843397 - log10(d0), -15_999.691510, 3.00088,  0.76315,  0.00460,  8.74432, -4.46921
    ], [ # ? Nitrogen
      17.56770785 - log10(d0),  -2_801.729072, 2.50031,  0.13732, -0.14660,  0.90066,  0.00000
    ], [ # ? Carbon Dioxide
      20.65844696 - log10(d0),  -4_902.171516, 2.50002,  2.04452, -1.06044,  2.03366,  0.01393
    ], [ # ? Ethane
      36.73005938 - log10(d0), -23_639.653010, 3.00263,  4.33939,  1.23722, 13.19740, -6.01989
    ], [ # ? Propane
      44.70909619 - log10(d0), -31_236.635510, 3.02939,  6.60569,  3.19700, 19.19210, -8.37267
    ], [ # ? Isobutane
      34.30180349 - log10(d0), -38_525.502760, 3.06714,  8.97575,  5.25156, 25.14230, 16.13880
    ], [ # ? n Butane
      36.53237783 - log10(d0), -38_957.809330, 3.33944,  9.44893,  6.89406, 24.46180, 14.78240
    ], [ # ? Isopentane
      43.17218626 - log10(d0), -51_198.309460, 3.00000, 11.76180, 20.11010, 33.16880,  0.00000
    ], [ # ? n Pentane
      42.67837089 - log10(d0), -45_215.830000, 3.00000,  8.95043, 21.83600, 33.40320,  0.00000
    ], [ # ? Hexane
      46.99717188 - log10(d0), -52_746.833180, 3.00000, 11.69770, 26.81420, 38.61640,  0.00000
    ], [ # ? Heptane
      52.07631631 - log10(d0), -57_104.810560, 3.00000, 13.72660, 30.47070, 43.55610,  0.00000
    ], [ # ? Octane
      57.25830934 - log10(d0), -60_546.763850, 3.00000, 15.68650, 33.80290, 48.17310,  0.00000
    ], [ # ? Nonane
      62.09646901 - log10(d0), -66_600.128370, 3.00000, 18.02410, 38.12350, 53.34150,  0.00000
    ], [ # ? Decane
      65.93909154 - log10(d0), -74_131.454830, 3.00000, 21.00690, 43.49310, 58.36570,  0.00000
    ], [ # ? Hydrogen
      13.07520288 - log10(d0),  -5_836.943696, 1.47906,  0.95806,  0.45444,  1.56039, -1.37560
    ], [ # ? Oxygen
      16.80171730 - log10(d0),  -2_318.322690, 2.50146,  1.07558,  1.01334,  0.00000,  0.00000
    ], [ # ? Carbon Monoxide
      17.45786899 - log10(d0),  -2_635.244116, 2.50055,  1.02865,  0.00493,  0.00000,  0.00000
    ], [ # ? Water
      21.57882705 - log10(d0),  -7_766.733078, 3.00392,  0.01059,  0.98763,  3.06904,  0.00000
    ], [ # ? Hydrogen Sulfide
      21.58309440 - log10(d0),  -6_069.035869, 3.00000,  3.11942,  1.00243,  0.00000,  0.00000
    ], [ # ? Helium
      10.04639507 - log10(d0),    -745.375000, 1.50000,  0.00000,  0.00000,  0.00000,  0.00000
    ], [ # ? Argon
      10.04639507 - log10(d0),    -745.375000, 1.50000,  0.00000,  0.00000,  0.00000,  0.00000
    ],
  ]

    # ? Gas - Gas Ideal Gas Parameters B
  th0i : Fields[array[1..7, float]] = [
    [    # ? Methane
      1.0, 1.0, 1.0, 820.659, 178.41, 1062.82, 1090.53,
    ], [ # ? Nitrogen
      1.0, 1.0, 1.0, 662.738, 680.562, 1740.06, 0,
    ], [ # ? Carbon Dioxide
      1.0, 1.0, 1.0, 919.306, 865.07, 483.553, 341.109,
    ], [ # ? Ethane
      1.0, 1.0, 1.0, 559.314, 223.284, 1031.38, 1071.29,
    ], [ # ? Propane
      1.0, 1.0, 1.0, 479.856, 200.893, 955.312, 1027.29,
    ], [ # ? Isobutane
      1.0, 1.0, 1.0, 438.27, 198.018, 1905.02, 893.765,
    ], [ # ? n-Butane
      1.0, 1.0, 1.0, 468.27, 183.636, 1914.1, 903.185,
    ], [ # ? Isopentane
      1.0, 1.0, 1.0, 292.503, 910.237, 1919.37, 0,
    ], [ # ? n-Pentane
      1.0, 1.0, 1.0, 178.67, 840.538, 1774.25, 0,
    ], [ # ? Hexane
      1.0, 1.0, 1.0, 182.326, 859.207, 1826.59, 0,
    ], [ # ? Heptane
      1.0, 1.0, 1.0, 169.789, 836.195, 1760.46, 0,
    ], [ # ? Octane
      1.0, 1.0, 1.0, 158.922, 815.064, 1693.07, 0,
    ], [ # ? Nonane
      1.0, 1.0, 1.0, 156.854, 814.882, 1693.79, 0,
    ], [ # ? Decane
      1.0, 1.0, 1.0, 164.947, 836.264, 1750.24, 0,
    ], [ # ? Hydrogen
      1.0, 1.0, 1.0, 228.734, 326.843, 1651.71, 1671.69,
    ], [ # ? Oxygen
      1.0, 1.0, 1.0, 2235.71, 1116.69, 0, 0,
    ], [ # ? Carbon Monoxide
      1.0, 1.0, 1.0, 1550.45, 704.525, 0, 0,
    ], [ # ? Water
      1.0, 1.0, 1.0, 268.795, 1141.41, 2507.37, 0,
    ], [ # ? Hydrogen Sulfide
      1.0, 1.0, 1.0, 1833.63, 847.181, 0, 0,
    ], [ # ? Helium
      1.0, 1.0, 1.0, 0, 0, 0, 0,
    ], [ # ? Argon
      1.0, 1.0, 1.0, 0, 0, 0, 0,
    ],
  ]

# * Only the following indices are defined in the C code. The rest are set to 0, so I'm
# * double checking here that the defined terms are in the correct slots
assert(kn[13] == 3)
assert(kn[14] == 2)
assert(kn[15] == 2)
assert(kn[16] == 2)
assert(kn[17] == 4)
assert(kn[18] == 4)
assert(kn[21] == 2)
assert(kn[22] == 2)
assert(kn[23] == 2)
assert(kn[24] == 4)
assert(kn[25] == 4)
assert(kn[26] == 4)
assert(kn[27] == 4)
assert(kn[29] == 1)
assert(kn[30] == 1)
assert(kn[31] == 2)
assert(kn[32] == 2)
assert(kn[33] == 3)
assert(kn[34] == 3)
assert(kn[35] == 4)
assert(kn[36] == 4)
assert(kn[37] == 4)
assert(kn[40] == 2)
assert(kn[41] == 2)
assert(kn[42] == 2)
assert(kn[43] == 4)
assert(kn[44] == 4)
assert(kn[46] == 2)
assert(kn[47] == 2)
assert(kn[48] == 4)
assert(kn[49] == 4)
assert(kn[51] == 2)
assert(kn[53] == 2)
assert(kn[54] == 1)
assert(kn[55] == 2)
assert(kn[56] == 2)
assert(kn[57] == 2)
assert(kn[58] == 2)

assert(fn[13] == 1)
assert(fn[27] == 1)
assert(fn[30] == 1)
assert(fn[35] == 1)

assert(gn[5] == 1)
assert(gn[6] == 1)
assert(gn[25] == 1)
assert(gn[29] == 1)
assert(gn[32] == 1)

assert(gn[33] == 1)
assert(gn[34] == 1)
assert(gn[51] == 1)
assert(gn[54] == 1)
assert(gn[56] == 1)

assert(qn[7] == 1)
assert(qn[16] == 1)
assert(qn[26] == 1)
assert(qn[28] == 1)
assert(qn[37] == 1)

assert(qn[42] == 1)
assert(qn[47] == 1)
assert(qn[49] == 1)
assert(qn[52] == 1)
assert(qn[58] == 1)

assert(sn[8] == 1)
assert(sn[9] == 1)

assert(wn[10] == 1)
assert(wn[11] == 1)
assert(wn[12] == 1)

assert(Qi[3]  == 0.69)
assert(Qi[18] == 1.06775)
assert(Qi[19] == 0.633276)
assert(Fi[15] == 1)
assert(Si[18] == 1.5822)
assert(Si[19] == 0.39)
assert(Wi[18] == 1)

assert(Eij[1][2] == 0.97164)
assert(Eij[1][3] == 0.960644)
assert(Eij[1][5] == 0.994635)
assert(Eij[1][6] == 1.01953)
assert(Eij[1][7] == 0.989844)
assert(Eij[1][8] == 1.00235)
assert(Eij[1][9] == 0.999268)
assert(Eij[1][10] == 1.107274)
assert(Eij[1][11] == 0.88088)
assert(Eij[1][12] == 0.880973)
assert(Eij[1][13] == 0.881067)
assert(Eij[1][14] == 0.881161)
assert(Eij[1][15] == 1.17052)
assert(Eij[1][17] == 0.990126)
assert(Eij[1][18] == 0.708218)
assert(Eij[1][19] == 0.931484)
assert(Eij[2][3] == 1.02274)
assert(Eij[2][4] == 0.97012)
assert(Eij[2][5] == 0.945939)
assert(Eij[2][6] == 0.946914)
assert(Eij[2][7] == 0.973384)
assert(Eij[2][8] == 0.95934)
assert(Eij[2][9] == 0.94552)
assert(Eij[2][15] == 1.08632)
assert(Eij[2][16] == 1.021)
assert(Eij[2][17] == 1.00571)
assert(Eij[2][18] == 0.746954)
assert(Eij[2][19] == 0.902271)
assert(Eij[3][4] == 0.925053)
assert(Eij[3][5] == 0.960237)
assert(Eij[3][6] == 0.906849)
assert(Eij[3][7] == 0.897362)
assert(Eij[3][8] == 0.726255)
assert(Eij[3][9] == 0.859764)
assert(Eij[3][10] == 0.855134)
assert(Eij[3][11] == 0.831229)
assert(Eij[3][12] == 0.80831)
assert(Eij[3][13] == 0.786323)
assert(Eij[3][14] == 0.765171)
assert(Eij[3][15] == 1.28179)
assert(Eij[3][17] == 1.5)
assert(Eij[3][18] == 0.849408)
assert(Eij[3][19] == 0.955052)
assert(Eij[4][5] == 1.02256)
assert(Eij[4][7] == 1.01306)
assert(Eij[4][9] == 1.00532)
assert(Eij[4][15] == 1.16446)
assert(Eij[4][18] == 0.693168)
assert(Eij[4][19] == 0.946871)
assert(Eij[5][7] == 1.0049)
assert(Eij[5][15] == 1.034787)
assert(Eij[6][15] == 1.3)
assert(Eij[7][15] == 1.3)
assert(Eij[10][19] == 1.008692)
assert(Eij[11][19] == 1.010126)
assert(Eij[12][19] == 1.011501)
assert(Eij[13][19] == 1.012821)
assert(Eij[14][19] == 1.014089)
assert(Eij[15][17] == 1.1)

assert(Uij[1][2] == 0.886106)
assert(Uij[1][3] == 0.963827)
assert(Uij[1][5] == 0.990877)
assert(Uij[1][7] == 0.992291)
assert(Uij[1][9] == 1.00367)
assert(Uij[1][10] == 1.302576)
assert(Uij[1][11] == 1.191904)
assert(Uij[1][12] == 1.205769)
assert(Uij[1][13] == 1.219634)
assert(Uij[1][14] == 1.233498)
assert(Uij[1][15] == 1.15639)
assert(Uij[1][19] == 0.736833)
assert(Uij[2][3] == 0.835058)
assert(Uij[2][4] == 0.816431)
assert(Uij[2][5] == 0.915502)
assert(Uij[2][7] == 0.993556)
assert(Uij[2][15] == 0.408838)
assert(Uij[2][19] == 0.993476)
assert(Uij[3][4] == 0.96987)
assert(Uij[3][10] == 1.066638)
assert(Uij[3][11] == 1.077634)
assert(Uij[3][12] == 1.088178)
assert(Uij[3][13] == 1.098291)
assert(Uij[3][14] == 1.108021)
assert(Uij[3][17] == 0.9)
assert(Uij[3][19] == 1.04529)
assert(Uij[4][5] == 1.065173)
assert(Uij[4][6] == 1.25)
assert(Uij[4][7] == 1.25)
assert(Uij[4][8] == 1.25)
assert(Uij[4][9] == 1.25)
assert(Uij[4][15] == 1.61666)
assert(Uij[4][19] == 0.971926)
assert(Uij[10][19] == 1.028973)
assert(Uij[11][19] == 1.033754)
assert(Uij[12][19] == 1.038338)
assert(Uij[13][19] == 1.042735)
assert(Uij[14][19] == 1.046966)

assert(Kij[1][2] == 1.00363)
assert(Kij[1][3] == 0.995933)
assert(Kij[1][5] == 1.007619)
assert(Kij[1][7] == 0.997596)
assert(Kij[1][9] == 1.002529)
assert(Kij[1][10] == 0.982962)
assert(Kij[1][11] == 0.983565)
assert(Kij[1][12] == 0.982707)
assert(Kij[1][13] == 0.981849)
assert(Kij[1][14] == 0.980991)
assert(Kij[1][15] == 1.02326)
assert(Kij[1][19] == 1.00008)
assert(Kij[2][3] == 0.982361)
assert(Kij[2][4] == 1.00796)
assert(Kij[2][15] == 1.03227)
assert(Kij[2][19] == 0.942596)
assert(Kij[3][4] == 1.00851)
assert(Kij[3][10] == 0.910183)
assert(Kij[3][11] == 0.895362)
assert(Kij[3][12] == 0.881152)
assert(Kij[3][13] == 0.86752)
assert(Kij[3][14] == 0.854406)
assert(Kij[3][19] == 1.00779)
assert(Kij[4][5] == 0.986893)
assert(Kij[4][15] == 1.02034)
assert(Kij[4][19] == 0.999969)
assert(Kij[10][19] == 0.96813)
assert(Kij[11][19] == 0.96287)
assert(Kij[12][19] == 0.957828)
assert(Kij[13][19] == 0.952441)
assert(Kij[14][19] == 0.948338)

assert(Gij[1][3] == 0.807653)
assert(Gij[1][15] == 1.95731)
assert(Gij[2][3] == 0.982746)
assert(Gij[3][4] == 0.370296)
assert(Gij[3][18] == 1.67309)

assert(n0i[1][1] == 29.83843397 - log10(d0))
assert(n0i[1][2] == -15999.69151)
assert(n0i[1][3] == 3.00088)
assert(n0i[1][4] == 0.76315)
assert(n0i[1][5] == 0.0046)
assert(n0i[1][6] == 8.74432)
assert(n0i[1][7] == -4.46921)

assert(n0i[2][1] == 17.56770785 - log10(d0))
assert(n0i[2][2] == -2801.729072)
assert(n0i[2][3] == 2.50031)
assert(n0i[2][4] == 0.13732)
assert(n0i[2][5] == -0.1466)
assert(n0i[2][6] == 0.90066)
assert(n0i[2][7] == 0)

assert(n0i[3][1] == 20.65844696 - log10(d0))
assert(n0i[3][2] == -4902.171516)
assert(n0i[3][3] == 2.50002)
assert(n0i[3][4] == 2.04452)
assert(n0i[3][5] == -1.06044)
assert(n0i[3][6] == 2.03366)
assert(n0i[3][7] == 0.01393)

assert(n0i[4][1] == 36.73005938 - log10(d0))
assert(n0i[4][2] == -23639.65301)
assert(n0i[4][3] == 3.00263)
assert(n0i[4][4] == 4.33939)
assert(n0i[4][5] == 1.23722)
assert(n0i[4][6] == 13.1974)
assert(n0i[4][7] == -6.01989)

assert(n0i[5][1] == 44.70909619 - log10(d0))
assert(n0i[5][2] == -31236.63551)
assert(n0i[5][3] == 3.02939)
assert(n0i[5][4] == 6.60569)
assert(n0i[5][5] == 3.197)
assert(n0i[5][6] == 19.1921)
assert(n0i[5][7] == -8.37267)

assert(n0i[6][1] == 34.30180349 - log10(d0))
assert(n0i[6][2] == -38525.50276)
assert(n0i[6][3] == 3.06714)
assert(n0i[6][4] == 8.97575)
assert(n0i[6][5] == 5.25156)
assert(n0i[6][6] == 25.1423)
assert(n0i[6][7] == 16.1388)

assert(n0i[7][1] == 36.53237783 - log10(d0))
assert(n0i[7][2] == -38957.80933)
assert(n0i[7][3] == 3.33944)
assert(n0i[7][4] == 9.44893)
assert(n0i[7][5] == 6.89406)
assert(n0i[7][6] == 24.4618)
assert(n0i[7][7] == 14.7824)

assert(n0i[8][1] == 43.17218626 - log10(d0))
assert(n0i[8][2] == -51198.30946)
assert(n0i[8][3] == 3)
assert(n0i[8][4] == 11.7618)
assert(n0i[8][5] == 20.1101)
assert(n0i[8][6] == 33.1688)
assert(n0i[8][7] == 0)

assert(n0i[9][1] == 42.67837089 - log10(d0))
assert(n0i[9][2] == -45215.83)
assert(n0i[9][3] == 3)
assert(n0i[9][4] == 8.95043)
assert(n0i[9][5] == 21.836)
assert(n0i[9][6] == 33.4032)
assert(n0i[9][7] == 0)

assert(n0i[10][1] == 46.99717188 - log10(d0))
assert(n0i[10][2] == -52746.83318)
assert(n0i[10][3] == 3)
assert(n0i[10][4] == 11.6977)
assert(n0i[10][5] == 26.8142)
assert(n0i[10][6] == 38.6164)
assert(n0i[10][7] == 0)

assert(n0i[11][1] == 52.07631631 - log10(d0))
assert(n0i[11][2] == -57104.81056)
assert(n0i[11][3] == 3)
assert(n0i[11][4] == 13.7266)
assert(n0i[11][5] == 30.4707)
assert(n0i[11][6] == 43.5561)
assert(n0i[11][7] == 0)

assert(n0i[12][1] == 57.25830934 - log10(d0))
assert(n0i[12][2] == -60546.76385)
assert(n0i[12][3] == 3)
assert(n0i[12][4] == 15.6865)
assert(n0i[12][5] == 33.8029)
assert(n0i[12][6] == 48.1731)
assert(n0i[12][7] == 0)

assert(n0i[13][1] == 62.09646901 - log10(d0))
assert(n0i[13][2] == -66600.12837)
assert(n0i[13][3] == 3)
assert(n0i[13][4] == 18.0241)
assert(n0i[13][5] == 38.1235)
assert(n0i[13][6] == 53.3415)
assert(n0i[13][7] == 0)

assert(n0i[14][1] == 65.93909154 - log10(d0))
assert(n0i[14][2] == -74131.45483)
assert(n0i[14][3] == 3)
assert(n0i[14][4] == 21.0069)
assert(n0i[14][5] == 43.4931)
assert(n0i[14][6] == 58.3657)
assert(n0i[14][7] == 0)

assert(n0i[15][1] == 13.07520288 - log10(d0))
assert(n0i[15][2] == -5836.943696)
assert(n0i[15][3] == 1.47906)
assert(n0i[15][4] == 0.95806)
assert(n0i[15][5] == 0.45444)
assert(n0i[15][6] == 1.56039)
assert(n0i[15][7] == -1.3756)

assert(n0i[16][1] == 16.8017173 - log10(d0))
assert(n0i[16][2] == -2318.32269)
assert(n0i[16][3] == 2.50146)
assert(n0i[16][4] == 1.07558)
assert(n0i[16][5] == 1.01334)
assert(n0i[16][6] == 0)
assert(n0i[16][7] == 0)

assert(n0i[17][1] == 17.45786899 - log10(d0))
assert(n0i[17][2] == -2635.244116)
assert(n0i[17][3] == 2.50055)
assert(n0i[17][4] == 1.02865)
assert(n0i[17][5] == 0.00493)
assert(n0i[17][6] == 0)
assert(n0i[17][7] == 0)

assert(n0i[18][1] == 21.57882705 - log10(d0))
assert(n0i[18][2] == -7766.733078)
assert(n0i[18][3] == 3.00392)
assert(n0i[18][4] == 0.01059)
assert(n0i[18][5] == 0.98763)
assert(n0i[18][6] == 3.06904)
assert(n0i[18][7] == 0)

assert(n0i[19][1] == 21.5830944 - log10(d0))
assert(n0i[19][2] == -6069.035869)
assert(n0i[19][3] == 3)
assert(n0i[19][4] == 3.11942)
assert(n0i[19][5] == 1.00243)
assert(n0i[19][6] == 0)
assert(n0i[19][7] == 0)

assert(n0i[20][1] == 10.04639507 - log10(d0))
assert(n0i[20][2] == -745.375)
assert(n0i[20][3] == 1.5)
assert(n0i[20][4] == 0)
assert(n0i[20][5] == 0)
assert(n0i[20][6] == 0)
assert(n0i[20][7] == 0)

assert(n0i[21][1] == 10.04639507 - log10(d0))
assert(n0i[21][2] == -745.375)
assert(n0i[21][3] == 1.5)
assert(n0i[21][4] == 0)
assert(n0i[21][5] == 0)
assert(n0i[21][6] == 0)
assert(n0i[21][7] == 0)

assert(th0i[1][4] == 820.659)
assert(th0i[1][5] == 178.41)
assert(th0i[1][6] == 1062.82)
assert(th0i[1][7] == 1090.53)

assert(th0i[2][4] == 662.738)
assert(th0i[2][5] == 680.562)
assert(th0i[2][6] == 1740.06)
assert(th0i[2][7] == 0)

assert(th0i[3][4] == 919.306)
assert(th0i[3][5] == 865.07)
assert(th0i[3][6] == 483.553)
assert(th0i[3][7] == 341.109)

assert(th0i[4][4] == 559.314)
assert(th0i[4][5] == 223.284)
assert(th0i[4][6] == 1031.38)
assert(th0i[4][7] == 1071.29)

assert(th0i[5][4] == 479.856)
assert(th0i[5][5] == 200.893)
assert(th0i[5][6] == 955.312)
assert(th0i[5][7] == 1027.29)

assert(th0i[6][4] == 438.27)
assert(th0i[6][5] == 198.018)
assert(th0i[6][6] == 1905.02)
assert(th0i[6][7] == 893.765)

assert(th0i[7][4] == 468.27)
assert(th0i[7][5] == 183.636)
assert(th0i[7][6] == 1914.1)
assert(th0i[7][7] == 903.185)

assert(th0i[8][4] == 292.503)
assert(th0i[8][5] == 910.237)
assert(th0i[8][6] == 1919.37)
assert(th0i[8][7] == 0)

assert(th0i[9][4] == 178.67)
assert(th0i[9][5] == 840.538)
assert(th0i[9][6] == 1774.25)
assert(th0i[9][7] == 0)

assert(th0i[10][4] == 182.326)
assert(th0i[10][5] == 859.207)
assert(th0i[10][6] == 1826.59)
assert(th0i[10][7] == 0)

assert(th0i[11][4] == 169.789)
assert(th0i[11][5] == 836.195)
assert(th0i[11][6] == 1760.46)
assert(th0i[11][7] == 0)

assert(th0i[12][4] == 158.922)
assert(th0i[12][5] == 815.064)
assert(th0i[12][6] == 1693.07)
assert(th0i[12][7] == 0)

assert(th0i[13][4] == 156.854)
assert(th0i[13][5] == 814.882)
assert(th0i[13][6] == 1693.79)
assert(th0i[13][7] == 0)

assert(th0i[14][4] == 164.947)
assert(th0i[14][5] == 836.264)
assert(th0i[14][6] == 1750.24)
assert(th0i[14][7] == 0)

assert(th0i[15][4] == 228.734)
assert(th0i[15][5] == 326.843)
assert(th0i[15][6] == 1651.71)
assert(th0i[15][7] == 1671.69)

assert(th0i[16][4] == 2235.71)
assert(th0i[16][5] == 1116.69)
assert(th0i[16][6] == 0)
assert(th0i[16][7] == 0)

assert(th0i[17][4] == 1550.45)
assert(th0i[17][5] == 704.525)
assert(th0i[17][6] == 0)
assert(th0i[17][7] == 0)

assert(th0i[18][4] == 268.795)
assert(th0i[18][5] == 1141.41)
assert(th0i[18][6] == 2507.37)
assert(th0i[18][7] == 0)

assert(th0i[19][4] == 1833.63)
assert(th0i[19][5] == 847.181)
assert(th0i[19][6] == 0)
assert(th0i[19][7] == 0)

assert(th0i[20][4] == 0)
assert(th0i[20][5] == 0)
assert(th0i[20][6] == 0)
assert(th0i[20][7] == 0)

assert(th0i[21][4] == 0)
assert(th0i[21][5] == 0)
assert(th0i[21][6] == 0)
assert(th0i[21][7] == 0)
